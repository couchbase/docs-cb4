<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference id="rest-node-services">
  <title>Enabling Couchbase Server Services</title>
  <shortdesc>Couchbase Server services are enabled when adding or joining a node to a cluster.</shortdesc>
  <refbody>
    
    <section><title>Syntax</title>
      <p>Adding a node syntax:</p>
      <codeblock>curl -u [admin]:[password]
  [localhost]:8091/controller/addNode 
  -d "hostname=[IPaddress]&amp;user=[admin]&amp;password=[password]"
  -d "services=[data | index | n1ql | fts | cbas | eventing]" </codeblock>
      
      <p>Joining a node to a cluster:</p>
      <codeblock>curl -u [admin]:[password] -d clusterMemberHostIp=[ip-address] 
  -d clusterMemberPort=[port] 
  -d user=[admin] -d password=[password] 
  http://[localhost]:8091/node/controller/doJoinCluster 
  -d "services=[data | index | n1ql | fts | cbas | eventing]"     </codeblock>
    </section> <section><title>Description</title>
      <p>This command is used to add a node to a cluster and specify the service.  If a service is
        not specified, the default (data) will be added. </p>
    
      <note type="attention">Couchbase Server services can only be enabled via the REST API when adding a
        server to an existing cluster. To initialized cluster (with the first node) with any
        Couchbase Server service other than the data service (default), use the Couchbase Web
        Console.</note>
      <p>When enabling the FTS service, ensure that you set the <parmname>ftsMemoryQuota</parmname>
        parameter as follows:
        <codeblock>curl -X POST -u Administrator:password \
  http://127.0.0.1:8091/pools/default \
  -d 'memoryQuota=256' \
  -d 'indexMemoryQuota=256' \
  -d 'ftsMemoryQuota=512'</codeblock></p>
    </section>
    
    <section><title>HTTP method and URI</title>
    <codeblock>POST /controller/addNode
POST /node/controller/doJoinCluster   </codeblock>
    </section>
    
   
    
    <section><title>Example</title>
      <p>Adding a node:</p>
      <codeblock>curl -u Administrator:password \
  10.2.2.60:8091/controller/addNode \
  -d &apos;hostname=10.2.2.64&amp;user=admin&amp;password=password&apos; \
  -d &apos;services=index&apos;     </codeblock>
      
      <p>Joining a node to a cluster:</p>
      <codeblock>curl -u Administrator:password -d clusterMemberHostIp=192.168.0.1 \
  -d &apos;clusterMemberPort=8091&apos; \
  -d &apos;user=admin&apos; -d &apos;password=password&apos; \
  http://10.5.2.54:8091/node/controller/doJoinCluster \
  -d &apos;services=index&apos;   </codeblock>
    </section>
    

  </refbody>
</reference>
