<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE reference PUBLIC "-//OASIS//DTD DITA Reference//EN" "reference.dtd">
<reference xml:lang="en-us" id="post-pools-default-buckets">
    <title>Create a new bucket</title>
    <shortdesc>To create a new bucket use <codeph>POST
        /pools/default/buckets</codeph>.</shortdesc>
    <refbody>
        <section>
            <title>Description</title>
            <p>This rest endpoint accepts a POST request to create a new bucket.</p>

        </section>
        <section>
            <title>HTTP Method and URI</title>
            <codeblock outputclass="language-http">POST http://&lt;host&gt;:8091/pools/default/buckets</codeblock>
        </section>
            <section><title>Body Parameters</title>
            <p>All of the following parameters are passed in the request body as <codeph>application/x-www-form-urlencoded</codeph> data. The parameters are specified as key-value pairs (e.g <codeph>key=value</codeph>).</p>
            <p><b>Required</b></p><table>
                <tgroup cols="3">
                    <colspec colname="col1" colwidth="1*"/>
                    <colspec colname="col2" colwidth="4*"/>
                    <colspec colname="col3" colwidth="1*"/>
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Description</entry>
                            <entry>Type</entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry><p><codeph>authType</codeph></p></entry>
                            <entry><p>Type of authentication to be used by a bucket. Specifying <codeph>sasl</codeph> causes the bucket to use SASL mechanisms to provide authenticated access to the bucket. Specifying <codeph>none</codeph> results in no authentication being applied for the bucket, although an alternative proxy port must be specified to allow access.</p>

                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>sasl</codeph></li>
                            <li><codeph>none</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>bucketType</codeph></p></entry>
                            <entry><p>Type of bucket to create.</p>

                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>memcached</codeph></li>
                            <li><codeph>couchbase</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>name</codeph></p></entry>
                            <entry><p>Name of the bucket to create. The bucket name can only contain characters in range A-Z, a-z, 0-9 as well as underscore, period, dash and percent and can be a maximum of 100 characters in length. The bucket name cannot be changed after bucket creation.</p>

                            </entry>
                            <entry>
                            <p>string</p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>ramQuotaMB</codeph></p></entry>
                            <entry><p>RAM Quota for the bucket in MB. The maximum can only be as great as the memory quota established for the node. If other buckets are associated with a node, RAM Quota can only be as large as the amount memory remaining for the node, accounting for the other bucket memory quota.</p>

                            </entry>
                            <entry>
                            <p>integer</p>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            <p><b>Optional</b></p><table>
                <tgroup cols="3">
                    <colspec colname="col1" colwidth="1*"/>
                    <colspec colname="col2" colwidth="4*"/>
                    <colspec colname="col3" colwidth="1*"/>
                    <thead>
                        <row>
                            <entry>Name</entry>
                            <entry>Description</entry>
                            <entry>Type</entry>
                        </row>
                    </thead>
                    <tbody>
                    
                        <row>
                            <entry><p><codeph>evictionPolicy</codeph></p></entry>
                            <entry><p>Ejection policy to be used by a bucket. <codeph>valueOnly</codeph> removes data from the cache but keeps all keys and metadata fields for non-resident items. <codeph>fullEviction</codeph> removes all data including keys, metadata, and key-value pairs from the cache for non-resident items. Full ejection is well suited for cases where the application has cold data that is not accessed frequently or the total data size is too large to fit in memory plus higher latency access to the data is accepted.</p>
 
<p>Defaults to <codeph>valueOnly</codeph> if unspecified.</p>                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>valueOnly</codeph></li>
                            <li><codeph>fullEviction</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>flushEnabled</codeph></p></entry>
                            <entry><p>Whether or not the <codeph>flush</codeph> operation is enabled on this bucket. A value of <codeph>1</codeph> enables the ability to trigger the 'flush' operation for the bucket while a value of <codeph>0</codeph> disables the ability to trigger a <codeph>flush</codeph>.</p>
 
                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>0</codeph></li>
                            <li><codeph>1</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>parallelDBAndViewCompaction</codeph></p></entry>
                            <entry><p>Indicates whether database and view files on disk can be compacted simultaneously. A value of <codeph>1</codeph> enables parallel compaction while a value of <codeph>0</codeph> disables parallel compaction.</p>
 
                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>0</codeph></li>
                            <li><codeph>1</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>proxyPort</codeph></p></entry>
                            <entry><p>Proxy port on which the bucket communicates and is used to identify the buckets. Must be specified if the bucket is not using <codeph>SASL</codeph> authentication. You can place non-SASL buckets on any available port except port 11211, which is reserved for the default bucket, you can place only one non-SASL bucket on an individual port. A value of <codeph>0</codeph> represents not specifying a proxy port.</p>
 
                            </entry>
                            <entry>
                            <p>integer</p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>replicaIndex</codeph></p></entry>
                            <entry><p>Whether replica view indexing is enabled for this bucket. Couchbase server recreates indexes using the replicated data on a node for each defined design document and view. Replica indexes enable you to perform queries even in the event of node failure as the replica index is queried while the active index is being rebuilt. A value of <codeph>1</codeph> enables replica indexing while a value of <codeph>0</codeph> disables replica indexing. This setting cannot be changed once the bucket has been created.</p>
 
<p>Defaults to <codeph>1</codeph> if unspecified.</p>                            </entry>
                            <entry>
                            <p>Possible values are:<ul>
                            <li><codeph>0</codeph></li>
                            <li><codeph>1</codeph></li>
</ul></p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>replicaNumber</codeph></p></entry>
                            <entry><p>Number of replicas for the bucket.</p>
 
                            <p>Must be between <codeph>0</codeph> and <codeph>3</codeph>.</p>
<p>Defaults to <codeph>1</codeph> if unspecified.</p>                            </entry>
                            <entry>
                            <p>integer</p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>saslPassword</codeph></p></entry>
                            <entry><p>Password for bucket access via smart clients. Required if SASL authentication has been enabled. An empty string value means that the bucket has no password set.</p>
 
                            </entry>
                            <entry>
                            <p>string</p>
                            </entry>
                        </row>
                        <row>
                            <entry><p><codeph>threadsNumber</codeph></p></entry>
                            <entry><p>Previous versions of Couchbase Server, version 3.0 or earlier, required the I/O thread allocation per bucket to be configured manually. Buckets allocated six to eight (6-8) threads are marked high priority in bucket settings. Buckets allocated three to five (3-5) threads are marked low priority in bucket settings.</p>
 
                            <p>Must be between <codeph>3</codeph> and <codeph>8</codeph>.</p>
<p>Defaults to <codeph>3</codeph> if unspecified.</p>                            </entry>
                            <entry>
                            <p>integer</p>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </table>
            </section>
            <section><title>Response Codes</title>
            <table>
            <tgroup cols="2">
                    <colspec colname="col1" colwidth="1*"/>
                    <colspec colname="col2" colwidth="4*"/>
            <thead>
                        <row>
                            <entry>Response Code</entry>
                            <entry>Description</entry>
                        </row>
                    </thead>
                    <tbody>
                    
                        <row>
                            <entry>202</entry>
                            <entry>Success.</entry>
                        </row>
                        <row>
                            <entry>400</entry>
                            <entry>There were errors with the passed parameters.</entry>
                        </row>
                        <row>
                            <entry>401</entry>
                            <entry>Unauthorized.</entry>
                        </row>
                    </tbody>
            </tgroup>
            </table>
            </section>
            <section>
            <title>Example Curl Command</title>
            <p>The following curl command creates a <codeph>couchbase</codeph> bucket called <codeph>travel-sample</codeph>, authenticated with a bucket password of <codeph>bucket_password</codeph>. The bucket is using value eviction with a RAM quota of 1000MB, replica view indexing is disabled.</p>

            <p><codeblock outputclass="language-bash">curl -X POST -u 'Administrator:password' 'http://localhost:8091/pools/default/buckets' -d 'authType=sasl' -d 'bucketType=couchbase' -d 'evictionPolicy=valueOnly' -d 'name=travel-sample' -d 'ramQuotaMB=1000' -d 'replicaIndex=0' -d 'saslPassword=bucket_password'</codeblock></p>
            </section>
            <section>
            <title>Example Response</title>
            <p><b>202</b></p>
            <p>This response code returns an empty body.</p>
            <p><b>400</b></p>
            <codeblock outputclass="language-json">{
    "errors": {
        "evictionPolicy": "Eviction policy must be either 'valueOnly' or 'fullEviction'",
        "flushEnable": "flushEnabled can only be 1 or 0",
        "name": "Bucket with given name already exists",
        "ramQuotaMB": "RAM quota specified is too large to be provisioned into this cluster.",
        "replicaIndex": "replicaIndex can only be 1 or 0",
        "replicaNumber": "Replica number larger than 3 is not supported.",
        "threadsNumber": "The number of threads can't be less than 2"
    },
    "summaries": {
        "ramSummaries": {
            "hddSummary": {
                "free": 53874699674,
                "otherBuckets": 180528059,
                "otherData": 9326771883,
                "thisUsed": 0,
                "total": ""
            },
            "ramSummaries": {
                "free": -46137344,
                "nodesCount": 1,
                "otherBuckets": 209715200,
                "perNodeMegs": 100,
                "thisAlloc": 104857600,
                "thisUsed": 0,
                "total": 268435456
            }
        }
    }
}</codeblock>
            <p><b>401</b></p>
            <p>This response code returns an empty body.</p>
            </section>
    </refbody>
</reference>