<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta description="A description of all configurable parameters for Couchbase Analytics.">
    <title>Couchbase Analytics configuration parameters</title>
  </head>
  <body>
    <main role="main"><article role="article" aria-labelledby="ariaid-title1">
    <div class="body">
      <!--
 ! Copyright 2016-2017 Couchbase, Inc.
 !-->
<h1 id="couchbase-analytics-service-configuration-parameters">Couchbase Analytics Service Configuration Parameters</h1>

<div class="note note"><span class="notetitle">Note:</span>
The configuration parameters for Analytics are volatile in the Developer Preview.
They may change significantly in the future.
</div>

<p>Couchbase Analytics Service has a number of configuration settings to customize the cluster for its environment.</p>

<p>The following parameters are at the instance level and are configured under the “[common]” section.</p>

<table>
  <thead>
    <tr>
      <th>Section</th>
      <th>Parameter</th>
      <th>Meaning</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>common</td>
      <td>compiler.framesize</td>
      <td>The page size (in bytes) for computation</td>
      <td>32768 (32 kB)</td>
    </tr>
    <tr>
      <td>common</td>
      <td>compiler.groupmemory</td>
      <td>The memory budget (in bytes) for a group by operator instance in a partition</td>
      <td>33554432 (32 MB)</td>
    </tr>
    <tr>
      <td>common</td>
      <td>compiler.joinmemory</td>
      <td>The memory budget (in bytes) for a join operator instance in a partition</td>
      <td>33554432 (32 MB)</td>
    </tr>
    <tr>
      <td>common</td>
      <td>compiler.parallelism</td>
      <td>The degree of parallelism for query execution. Zero means to use the storage parallelism as the query execution parallelism, while other integer values dictate the number of query execution parallel partitions. The system will fall back to use the number of all available CPU cores in the cluster as the degree of parallelism if the number set by a user is too large or too small</td>
      <td>0</td>
    </tr>
    <tr>
      <td>common</td>
      <td>compiler.sortmemory</td>
      <td>The memory budget (in bytes) for a sort operator instance in a partition</td>
      <td>33554432 (32 MB)</td>
    </tr>
    <tr>
      <td>common</td>
      <td>log.level</td>
      <td>The logging level for master and slave processes</td>
      <td>WARNING</td>
    </tr>
    <tr>
      <td>common</td>
      <td>max.wait.active.cluster</td>
      <td>The max pending time (in seconds) for cluster startup. After the threshold, if the cluster still is not up and running, it is considered unavailable</td>
      <td>60</td>
    </tr>
    <tr>
      <td>common</td>
      <td>metadata.callback.port</td>
      <td>IP port to bind metadata callback listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>common</td>
      <td>metadata.listen.port</td>
      <td>IP port to bind metadata listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>common</td>
      <td>metadata.node</td>
      <td>the node which should serve as the metadata node</td>
      <td>&lt;undefined&gt;</td>
    </tr>
    <tr>
      <td>common</td>
      <td>metadata.registration.timeout.secs</td>
      <td>how long in seconds to wait for the metadata node to register with the master node</td>
      <td>60</td>
    </tr>
  </tbody>
</table>

<p>The following parameters are for the master process, under the “[cc]” section.</p>

<table>
  <thead>
    <tr>
      <th>Section</th>
      <th>Parameter</th>
      <th>Meaning</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cc</td>
      <td>address</td>
      <td>Default bind address for all services on the master node</td>
      <td>127.0.0.1</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>analytics.http.listen.address</td>
      <td>The IP address on which the Couchbase Analytics listens</td>
      <td>127.0.0.1</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>analytics.http.listen.port</td>
      <td>The port on which the Couchbase Analytics listens</td>
      <td>8095</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>analytics.http.request.queue.size</td>
      <td>The maximum number of HTTP requests to queue pending ability to execute</td>
      <td>256</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>analytics.http.thread.count</td>
      <td>The number of threads to service HTTP requests</td>
      <td>16</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>client.listen.address</td>
      <td>Sets the IP Address to listen for connections from clients</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>client.listen.port</td>
      <td>Sets the port to listen for connections from clients</td>
      <td>1098</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>cluster.listen.address</td>
      <td>Sets the IP Address to listen for connections from slave nodes</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>cluster.listen.port</td>
      <td>Sets the port to listen for connections from node controllers</td>
      <td>1099</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>cluster.public.address</td>
      <td>Address that slave nodes should use to contact this master node</td>
      <td>same as cluster.listen.address</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>cluster.public.port</td>
      <td>Port that slave nodes should use to contact this master node</td>
      <td>same as cluster.listen.port</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>console.listen.address</td>
      <td>Sets the listen address for the administration console on the master node</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>console.listen.port</td>
      <td>Sets the http port for the administration console on the master node</td>
      <td>16001</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>heartbeat.max.misses</td>
      <td>Sets the maximum number of missed heartbeats before a node is marked as dead</td>
      <td>5</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>heartbeat.period</td>
      <td>Sets the time duration between two heartbeats from each node controller in milliseconds</td>
      <td>10000</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>job.history.size</td>
      <td>Limits the number of historical jobs remembered by the system to the specified value</td>
      <td>10</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>job.queue.capacity</td>
      <td>The maximum number of jobs to queue before rejecting new jobs</td>
      <td>4096</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>result.sweep.threshold</td>
      <td>The duration within which an instance of the result cleanup should be invoked in milliseconds</td>
      <td>60000</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>result.ttl</td>
      <td>Limits the amount of time results for asynchronous jobs should be retained by the system in milliseconds</td>
      <td>86400000</td>
    </tr>
    <tr>
      <td>cc</td>
      <td>root.dir</td>
      <td>Sets the root folder used for temporary files used by the master process</td>
      <td>“analytics/ClusterControllerService” under “java.io.tmpdir”</td>
    </tr>
  </tbody>
</table>

<p>The following parameters are for slave processes, under the “[nc]” or “[nc/xxx]” section.
The former (“[nc]”) is for all slave processes, while the latter “[nc/xxx]” (where “xxx” should be replaced by a particular slave name)
is for the particular slave process and can override parameters defined in “[nc]”.</p>

<table>
  <thead>
    <tr>
      <th>Section</th>
      <th>Parameter</th>
      <th>Meaning</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>nc</td>
      <td>address</td>
      <td>Default IP Address to bind listeners on this slave node.  All services will bind on this address unless a service-specific listen address is supplied.</td>
      <td>127.0.0.1</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>cluster.connect.retries</td>
      <td>Number of attempts to contact the master node before giving up</td>
      <td>5</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>cluster.listen.address</td>
      <td>IP Address to bind cluster listener (for management events) on this slave node</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>cluster.listen.port</td>
      <td>IP port to bind cluster listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>cluster.public.address</td>
      <td>Public IP Address to announce cluster listener</td>
      <td>same as public.address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>cluster.public.port</td>
      <td>Public IP port to announce cluster listener</td>
      <td>same as cluster.listen.port</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>core.dump.dir</td>
      <td>The directory where node core dumps should be written</td>
      <td>“analytics/coredump” under “java.io.tmpdir”</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>data.listen.address</td>
      <td>IP Address to bind data listener (for data exchange)</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>data.listen.port</td>
      <td>IP port to bind data listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>data.public.address</td>
      <td>Public IP Address to announce data listener</td>
      <td>same as public.address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>data.public.port</td>
      <td>Public IP port to announce data listener</td>
      <td>same as data.listen.port</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>iodevices</td>
      <td>Comma separated list of directories for storing data, typically, one directory per disk device</td>
      <td>“analytics/iodevice” under “java.io.tmpdir”</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>jvm.args</td>
      <td>JVM args to pass to the slave JVM</td>
      <td>&lt;undefined&gt;</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>messaging.listen.address</td>
      <td>IP Address to bind messaging listener (for message exchange among slave nodes)</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>messaging.listen.port</td>
      <td>IP port to bind messaging listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>messaging.public.address</td>
      <td>Public IP Address to announce messaging listener</td>
      <td>same as public.address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>messaging.public.port</td>
      <td>Public IP port to announce messaging listener</td>
      <td>same as messaging.listen.port</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>ncservice.address</td>
      <td>Address the master node should use to contact the NCService associated with this slave node</td>
      <td>same as public.address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>ncservice.port</td>
      <td>Port the master node should use to contact the NCService associated with this slave node</td>
      <td>9090</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>net.buffer.count</td>
      <td>Number of network buffers per input/output channel</td>
      <td>1</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>net.thread.count</td>
      <td>Number of threads to use for Network I/O</td>
      <td>1</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>public.address</td>
      <td>Default public address that other processes should use to contact this slave node.  All services will advertise this address unless a service-specific public address is supplied.</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.listen.address</td>
      <td>IP Address to bind dataset result distribution listener</td>
      <td>same as address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.listen.port</td>
      <td>IP port to bind dataset result distribution listener (0 = random port)</td>
      <td>0</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.manager.memory</td>
      <td>Memory usable for result caching at this slave node in bytes</td>
      <td>-1 (-1 B)</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.public.address</td>
      <td>Public IP Address to announce dataset result distribution listener</td>
      <td>same as public.address</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.public.port</td>
      <td>Public IP port to announce dataset result distribution listener</td>
      <td>same as result.listen.port</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.sweep.threshold</td>
      <td>The duration within which an instance of the result cleanup should be invoked in milliseconds</td>
      <td>60000</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>result.ttl</td>
      <td>Limits the amount of time results for asynchronous jobs should be retained by the system in milliseconds</td>
      <td>86400000</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.buffercache.maxopenfiles</td>
      <td>The maximum number of open files in the buffer cache</td>
      <td>2147483647</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.buffercache.pagesize</td>
      <td>The page size in bytes for pages in the buffer cache</td>
      <td>131072 (128 kB)</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.buffercache.size</td>
      <td>The maximum size of memory allocated to the disk buffer cache.  The value should be a multiple of the buffer cache page size.</td>
      <td>1/4th of the slave JVM heap size</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.lsm.bloomfilter.falsepositiverate</td>
      <td>The maximum acceptable false positive rate for bloom filters associated with indexes</td>
      <td>0.01</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.memorycomponent.globalbudget</td>
      <td>The maximum size of memory allocated to all memory components.  The value should be a multiple of the memory component page size.</td>
      <td>1/4th of the slave JVM heap size</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.memorycomponent.numcomponents</td>
      <td>The maximum number of memory components to be used per index</td>
      <td>2</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.memorycomponent.numpages</td>
      <td>The maximum number of pages to allocate for memory components of a dataset. This budget is shared by all the memory components of the primary index and all its secondary indexes across all partitions for one dataset on one node.</td>
      <td>1/16th of the storage.memorycomponent.globalbudget value</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.memorycomponent.pagesize</td>
      <td>The page size in bytes for pages allocated to memory components</td>
      <td>131072 (128 kB)</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.metadata.memorycomponent.numpages</td>
      <td>The number of pages to allocate for a metadata dataset</td>
      <td>1/64th of the storage.memorycomponent.globalbudget value or 256, whichever is larger</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>storage.subdir</td>
      <td>The subdirectory name under each iodevice used for storage</td>
      <td>storage</td>
    </tr>
    <tr>
      <td>nc</td>
      <td>txn.log.dir</td>
      <td>The directory where transaction logs should be stored</td>
      <td>“analytics/txn-log” under “java.io.tmpdir”</td>
    </tr>
  </tbody>
</table>

<h2 id="sample-local-cluster">Sample Local Cluster</h2>
<p>The sample local cluster is configured with the following locations (non-file entries stripped for brevity):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>[nc/red]
core.dump.dir=data/red/coredump
iodevices=data/red

[nc/blue]
core.dump.dir=data/blue/coredump
iodevices=data/blue

[nc]
storage.subdir=storage
</code></pre>
</div>

<p>All paths are relative to the sample local cluster root, i.e., $INSTALL_DIR/opt/local.</p>

<p>A layout of directories / files in the running sample cluster:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#### blue nc data
opt/local/data/blue/root_metadata/blue_iodevice0/.root_metadata
opt/local/data/blue/storage/partition_1/Couchbase
opt/local/data/blue/txnlog/transaction_log_16
opt/local/data/blue/txnlog/checkpoint_1471323244720

#### red nc data
opt/local/data/red/root_metadata/red_iodevice0/.root_metadata
opt/local/data/red/storage/partition_0/Couchbase
opt/local/data/red/storage/partition_0/Metadata
opt/local/data/red/txnlog/transaction_log_13
opt/local/data/red/txnlog/checkpoint_1471323244729

#### logs
opt/local/logs/blue-service.log
opt/local/logs/cc.log
opt/local/logs/red-service.log
</code></pre>
</div>

    </div>
    </article>
    </main>
  </body>
</html>
