<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta description="How to run queries in Couchbase Analytics.">
    <title>Running query</title>
  </head>
  <body>
    <main role="main"><article role="article" aria-labelledby="ariaid-title1">
    <div class="body">
      <!--
 ! Copyright 2016-2017 Couchbase, Inc.
 !-->

<p>#Running Queries</p>

<p>You can run queries using the Analytics Workbench, the command line query tool, cbq;
or directly through the REST API.</p>

<h2 id="-using-the-analytics-workbench"><a id="Using_analytics_workbench"> Using the Analytics Workbench</a></h2>
<p>A custom standalone Analytics Workbench is available with the Developer Preview.
Open a browser and go to http://localhost:8095 to access the Analytics Workbench.
We recommend Google Chrome or Mozilla Firefox browsers.</p>

<div class="note note"><span class="notetitle">Note:</span> For the Docker image, the URL
may be different as explained in the <a class="xref" href="#Using_docker">Using Docker</a> section. </div>

<p>Enter the following test query and click Execute:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>SELECT "Hello, beer!" AS greeting;
</code></pre>
</div>

<div class="note note"><span class="notetitle">Note:</span> You must press the <strong class="ph b">Execute</strong>
button in the Analytics Workbench; unlike Query Workbench, pressing <strong class="ph b">Enter</strong>
or <strong class="ph b">Return</strong> will not immediately execute a statement because Analytics accepts
multi-line statements.</div>

<p><img class="image" id="topic_iwb_gbn_qx__image_e5d_mrj_rx" src="images/workbench-results.png" /></p>

<h2 id="using-the-command-line-query-tool"><a id="Using_command_line">Using the Command Line Query Tool</a></h2>

<p>You can use the command line tool, cbq, to run queries. The cbq is the command line shell
for executing queries against Couchbase Server. Analytics contains a special version of cbq that works
with the analytics service and can execute multi-line statements. Make sure you use the version of cbq located
in your Analytics install folder.</p>

<p>Run cbq with the following options to specify the host and port for the query service:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ cbq -b=on -e "http://127.0.0.1:8095/"
</code></pre>
</div>

<p>Enter the statements in cbq:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>cbq&gt; create bucket beerBucket with { "bucket": "beer-sample", "nodes": "127.0.0.1" };
cbq&gt; create shadow dataset beers on beerBucket;
cbq&gt; connect bucket beerBucket with { "password": "" };
</code></pre>
</div>

<h2 id="using-the-rest-api"><a id="Using_the_REST_API">Using the REST API</a></h2>
<p>When the cluster is up, requests can be posted to Couchbase Server.
Access http://localhost:8095/analytics/service that implements the same interface as the Couchbase
N1QL query service.</p>

<p>Using curl, where $FILE contains the name of a file on your file system, run the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>curl -s --data pretty=true --data-urlencode statement@$FILE http://localhost:8095/analytics/service
</code></pre>
</div>

<p>You can also use the REST API to run analytic queries. For details, see Analytics REST API.
Here are some examples using curl:</p>

<p>To check the analytics version, run the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>curl -v http://localhost:8095/analytics/version
</code></pre>
</div>

<p>To query the cluster, run the following command:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>curl -v http://localhost:8095/analytics/cluster
</code></pre>
</div>


    </div>
    </article>
    </main>
  </body>
</html>
