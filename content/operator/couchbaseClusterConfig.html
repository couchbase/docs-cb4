<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Couchbase Documentation</title>
    <link rel="stylesheet" href="../../_/css/site.css">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager -->
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<link rel="shortcut icon" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon.ico" type="image/x-icon">
<link rel="icon" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="57x57" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/webfiles/1498186094252/images/icons/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/favicon-16x16.png">
<link rel="manifest" href="https://developer.couchbase.com/webfiles/1498186094252/images/icons/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/webfiles/1498186094252/images/icons/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<!--    _____________________________
_______/ Support for legacy browsers \_______________________________________-->
<!--[if lte IE 8]>
<script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/vendor/html5shiv.js" />
<script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/vendor/respond.js" />
<![endif]-->
<!--[if IE 9]>
<script type="text/javascript" charset="utf-8" src="/webfiles/1498186094252/js/thirdparty/classList.js" />
<![endif]-->
<!--_________________________________________________________________________-->
<script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/jquery-migrate.js"></script>
<script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/slick.js"></script>
<script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/isotope.min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/imagesloaded.min.js"></script>

<meta name="apple-mobile-web-app-title" content="Couchbase">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="1gPO0RaMzKyZJFpS-iyIEnPsWDztwZH0R3vG1VpSwvM" />

<!-- LOCAL CSS Libs -->
<link rel="stylesheet" href="https://developer.couchbase.com/webfiles/1498186094252/css/styles.css">

<!-- Default canonical comes from the URL -->
<link rel="canonical" href="http://developer.couchbase.com"/>
<title>Couchbase</title>
<link rel="stylesheet" href="https://developer.couchbase.com/binaries/content/assets/css/overrides.css">
  </head>
  <body style="padding: 0 !important;">
<!-- Google Tag Manager -->
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MVPNN2" height="0"
          width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager -->
<script>
  var overrideJsPath = "/binaries/content/assets/js/overrides.js";
  $.ajax({
    url: overrideJsPath,
    type: 'HEAD',
    error: function () {
    },
    success: function () {
      // file exists
      $.getScript(overrideJsPath);
    }
  });
</script>
<!--    ________________
_______/ INCLUDE HEADER - BODY - FOOTER \____________________________________________________-->
<!-- begin - include ref= -->
<nav class="aux">
  <div>
  </div>
</nav>
<!-- Beginning of site.../jsp/base/header.jsp -->
<header id="global-header" class="global-header dev-portal">
  <div class="layout-wrapper">
    <div class="global-header__logo">
      <a href='http://www.couchbase.com'>Couchbase</a>
      <a href='index.html'>Developer</a>

    </div>

    <a data-modules="navigation,globalheadersearch"></a>
    <nav role="navigation" id="primary-navigation" class="primary-navigation">
      <button aria-controls="primary-navigation__wrapper"
              aria-pressed="false"
              class="primary-navigation__toggler"
              type="button">

        <span>Menu</span>
      </button>
      <div id="primary-navigation__wrapper"
           class="primary-navigation__wrapper"
           aria-expanded="false">

        <ul class="primary-navigation__items">
          <li class="primary-navigation__item ">

            <a href="https://developer.couchbase.com/documentation/server/current/introduction/intro.html">Server</a>
          </li>
          <li class="primary-navigation__item ">

            <a href="https://developer.couchbase.com/mobile">Mobile</a>
          </li>
          <li class="primary-navigation__item has-secondary-navigation">

            <a href="https://developer.couchbase.com/community">Community</a>
            <div class="secondary-navigation">
              <ul class="secondary-navigation__items">
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/open-source-projects">Open Source Projects</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/contribute">Contribute</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://www.couchbase.com/nosql-resources/events">Events</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/experts-and-champions">Experts &amp; Champions</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://forums.couchbase.com/">Forums</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="http://blog.couchbase.com">Blogs</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/support">Support</a>
                </li>
              </ul>
            </div>
          </li>
          <li class="primary-navigation__item has-secondary-navigation">

            <a href="https://developer.couchbase.com/guides-and-references">Site Map</a>
            <div class="secondary-navigation">
              <ul class="secondary-navigation__items">
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#section-1">Couchbase Server</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#section-2">Couchbase Mobile</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#subsection-1-3">SDKs</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/guides-and-references#subsection-1-5">Connectors</a>
                </li>
                <li class="secondary-navigation__item">
                  <a href="https://developer.couchbase.com/documentation-archive">Documentation Archive</a>
                </li>
              </ul>
            </div>
          </li>
        </ul>
        <form id="global-header-search"
              autocomplete="off"
              class="global-header-search global-header-search--js"
              action="https://developer.couchbase.com/search"
              aria-expanded="false">
          <ul><!--
            ---><li>
            <label for="global-header-search__query">
              Search query
            </label>
            <input
              type="search"
              placeholder="Search"
              name="q"
              value=""
              id="global-header-search__query">
          </li><!--
                ---><li>
            <button type="submit">
              <span>Search</span>
            </button>
          </li><!--
        ---></ul>
          <button aria-controls="global-header-search__items"
                  aria-pressed="false"
                  class="global-header-search__toggler"
                  type="button">
            <span>Search</span>
          </button><!--
        --->

          <div style="display: none" about="custom-search-fields">

            <input type="hidden"
                   name="cx"
                   value="017928787631531434501:3e7lwhjxsom" />
            <input type="hidden"
                   name="cof"
                   value="FORID:11" />
            <input type="hidden"
                   name="safe"
                   value="off" />
            <input type="hidden"
                   name="form_build_id"
                   value="form-RrbKDUhO3kB2MiqBdZHIQI9L4LFE7c3L_s87N2B9BZo" />
            <input type="hidden"
                   name="form_id"
                   value="google_cse_results_searchbox_form" />
            <input type="hidden"
                   name="siteurl"
                   value='developer.couchbase.com' />

          </div>
        </form>
      </div>
    </nav>
    <a class="global-header__download-button" href="https://developer.couchbase.com/downloads">
      Download
    </a>
  </div>
</header>
<div class="main-wrapper">
<div class="navigation-container">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <span class="nav-text"></span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Couchbase Operator User&#8217;s Guide</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="prerequisiteAndSetup.html">Prerequisites and Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="installKubernetes.html">Kubernetes Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="installKubernetesNoRBAC.html">Kubernetes Setup (RBAC Disabled)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="installOpenShift.html">OpenShift Setup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="operatorConfig.html">Couchbase Operator Configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="deployingCouchbase.html">Deploying a Couchbase Cluster</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="couchbaseClusterConfig.html">CouchbaseCluster Configuration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="clusterStatusGuide.html">Displaying the Status of a CouchbaseCluster</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="listAndDescribe.html">Viewing the Pods/Services Created</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cbopctl.html">Ensuring Valid CouchbaseCluster Configurations With cbopctl</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="accessingCouchbase.html">Accessing Couchbase</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="adminConsoleAccess.html">Using the Couchbase Web Console</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="couchbaseCliGuide.html">Using the Couchbase CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="couchbaseClients.html">Using Couchbase Clients</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <a class="nav-link" href="runningCouchbase.html">Running Couchbase on Kubernetes or OpenShift</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="scalingCouchbase.html">Scaling a CouchbaseCluster</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="nodeRecovery.html">Recovering from a Node Failure</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="updatingCouchbase.html">Updating a CouchbaseCluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="deleteCouchbaseCluster.html">Deleting a CouchbaseCluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-toggle"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="logsTroubleshooting.html">Logs and Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="conditionsAndEvents.html">Conditions and Events</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="demo.html">Tutorial</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="releaseNotes.html">v0.8 Beta Release Notes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="current">
    <span class="title">Couchbase Operator User&#x27;s Guide</span>
    <span class="version">0.8</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Couchbase Operator User's Guide</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../beta/overview.html">beta</a>
        </li>
        <li class="version is-current">
          <a href="overview.html">0.8</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Home</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../home/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation" style="display: none;">
  <button class="navigation-toggle"></button>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
  <ul>
    <li class="crumb">Couchbase Operator User&#8217;s Guide</li>
    <li class="crumb"><a href="deployingCouchbase.html">Deploying a Couchbase Cluster</a></li>
    <li class="crumb"><a href="couchbaseClusterConfig.html">CouchbaseCluster Configuration</a></li>
  </ul>
</nav>
</div>
    <div class="body">
      <style>
        .doc h1 > a.anchor,
        .doc h2 > a.anchor,
        .doc h3 > a.anchor,
        .doc h4 > a.anchor,
        .doc h5 > a.anchor,
        .doc h6 > a.anchor {
          position: absolute;
          text-decoration: none;
          width: 1.75ex;
          margin-left: -1.5ex;
          visibility: hidden;
          font-size: 0.8em;
        }

        .doc h1 > a.anchor::before,
        .doc h2 > a.anchor::before,
        .doc h3 > a.anchor::before,
        .doc h4 > a.anchor::before,
        .doc h5 > a.anchor::before,
        .doc h6 > a.anchor::before {
          content: "\00a7";
        }

        .doc h1:hover > a.anchor,
        .doc h2:hover > a.anchor,
        .doc h3:hover > a.anchor,
        .doc h4:hover > a.anchor,
        .doc h5:hover > a.anchor,
        .doc h6:hover > a.anchor {
          visibility: visible;
        }
      </style>

<article class="doc">
<div class="sect1">
<h2 id="couchbasecluster-configuration"><a class="anchor" href="#couchbasecluster-configuration"></a>CouchbaseCluster Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following sample CouchbaseCluster configuration file lists all of
the configuration parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: couchbase.database.couchbase.com/v1beta1
kind: CouchbaseCluster
metadata:
  name: cb-example
  namespace: default
spec:
  baseImage: couchbase/server
  version: enterprise-5.0.1
  paused: false
  antiAffinity: true
  authSecret: my-secret
  exposeAdminConsole: true
  adminConsoleServices:
    - data
  cluster:
    dataServiceMemoryQuota: 256
    indexServiceMemoryQuota: 256
    searchServiceMemoryQuota: 256
    indexStorageSetting: default
    autoFailoverTimeout: 30
  buckets:
    - name: default
      type: couchbase
      memoryQuota: 1024
      replicas: 1
      ioPriority: high
      eviction-policy: value-eviction
      conflictResolution: seqno
      enableFlush: true
      enableIndexReplica: false
  servers:
    - size: 1
      name: all_services
      services:
        - data
        - index
        - query
        - search
      dataPath: /opt/couchbase/var/lib/couchbase/data
      indexPath: /opt/couchbase/var/lib/couchbase/data
      pod:
        couchabseEnv:
          ENV1: value
        resources:
          limits:
            cpu: 4GHz
            memory: 8GiB
            storage: 100GiB
          requests:
            cpu: 2GHz
            memory: 8GiB
            storage: 50GiB
        labels:
          couchbase_services: all
        nodeSelector:
          instanceType: large
        tolerations:
          - key: app
            operator: Equal
            value: cbapp
            effect: NoSchedule
        automountServiceAccountToken: false</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#top-level-definitions">Top-Level Definitions</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#apiversion">apiversion</a></p>
</li>
<li>
<p><a href="#kind">kind</a></p>
</li>
<li>
<p><a href="#metadata">metadata</a></p>
</li>
<li>
<p><a href="#spec">spec</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#spec-the-top-level">Spec: The Top-Level</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#baseimage">baseImage</a></p>
</li>
<li>
<p><a href="#version">version</a></p>
</li>
<li>
<p><a href="#paused">paused</a></p>
</li>
<li>
<p><a href="#antiaffinity">antiAffinity</a></p>
</li>
<li>
<p><a href="#authsecret">authSecret</a></p>
</li>
<li>
<p><a href="#exposeadminconsole">exposeAdminConsole</a></p>
</li>
<li>
<p><a href="#adminconsoleservices">adminConsoleServices</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#spec-the-cluster-settings">Spec: The Cluster Settings</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#dataservicememoryquota">dataServiceMemoryQuota</a></p>
</li>
<li>
<p><a href="#indexservicememoryquota">indexServiceMemoryQuota</a></p>
</li>
<li>
<p><a href="#searchservicememoryquota">searchServiceMemoryQuota</a></p>
</li>
<li>
<p><a href="#indexstoragetype">indexStorageType</a></p>
</li>
<li>
<p><a href="#autofailovertimeout">autoFailoverTimeout</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#spec-bucket-settings">Spec: Bucket Settings</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#name">name</a></p>
</li>
<li>
<p><a href="#type">type</a></p>
</li>
<li>
<p><a href="#memoryquota">memoryQuota</a></p>
</li>
<li>
<p><a href="#replicas">replicas</a></p>
</li>
<li>
<p><a href="#iopriority">ioPriority</a></p>
</li>
<li>
<p><a href="#evictionpolicy">evictionPolicy</a></p>
</li>
<li>
<p><a href="#conflictresolution">conflictResolution</a></p>
</li>
<li>
<p><a href="#enableflush">enableFlush</a></p>
</li>
<li>
<p><a href="#enableindexreplicas">enableIndexReplicas</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#spec-servers">Spec: Servers</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#size">size</a></p>
</li>
<li>
<p><a href="#name">name</a></p>
</li>
<li>
<p><a href="#services">services</a></p>
</li>
<li>
<p><a href="#datapath">dataPath</a></p>
</li>
<li>
<p><a href="#indexpath">indexPath</a></p>
</li>
<li>
<p><a href="#the-pod-policy">The Pod Policy</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#couchbaseenv">couchbaseEnv</a></p>
</li>
<li>
<p><a href="#resources">Resources</a></p>
<div class="ulist">
<ul>
<li>
<p><a href="#limits">limits</a></p>
</li>
<li>
<p><a href="#requests">requests</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="#labels">labels</a></p>
</li>
<li>
<p><a href="#nodeselector">nodeSelector</a></p>
</li>
<li>
<p><a href="#tolerations">tolerations</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="top-level-definitions"><a class="anchor" href="#top-level-definitions"></a>Top-Level Definitions</h3>
<div class="paragraph">
<p>The following are the top-level parameters for a CouchbaseCluster
configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: couchbase.database.couchbase.com/v1beta1
kind: CouchbaseCluster
metadata:
  name: cb-example
  namespace: default
spec:
...</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="apiversion"><a class="anchor" href="#apiversion"></a>apiversion</h4>
<div class="paragraph">
<p>This field specifies the API Version for our integration. As our
integration changes over time, you can change the API Version whenever
new features are added. For any given release, the API Versions that are
supported by that Operator will be specified in our documentation. We
also always recommend that you upgrade to the latest API Version when
possible.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be set to a valid API
Version. The value of this field cannot be changed after the cluster is
created.</p>
</div>
</div>
<div class="sect3">
<h4 id="kind"><a class="anchor" href="#kind"></a>kind</h4>
<div class="paragraph">
<p>This field specifies that this Kubernetes configuration will use the
custom Couchbase controller to manage the cluster.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must always be set to
<code>CouchbaseCluster</code>. The value of this field cannot be changed after the
cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="metadata"><a class="anchor" href="#metadata"></a>metadata</h4>
<div class="paragraph">
<p>Allows setting a name for the Couchbase cluster and a namespace that the
cluster should be deployed in.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> A name is highly recommended, but not required. If values
are not set in the metadata field then defaults will be set. The value
of <code>name</code> will be autogenerated and the value of <code>namespace</code> will be set
to <code>default</code>. The value of these fields cannot be changed after the
cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="spec"><a class="anchor" href="#spec"></a>spec</h4>
<div class="paragraph">
<p>This field contains the specification on how the Couchbase cluster must
be deployed.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spec-the-top-level"><a class="anchor" href="#spec-the-top-level"></a>Spec: The Top-Level</h3>
<div class="paragraph">
<p>This section describes the top-level parameters related to a Couchbase
cluster deployment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
  baseImage: couchbase/server
  version: enterprise-5.0.1
  paused: false
  antiAffinity: true
  authSecret: my-auth-secret
  exposeAdminConsole: true
  adminConsoleServices:
    - data
...</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="baseimage"><a class="anchor" href="#baseimage"></a>baseImage</h4>
<div class="paragraph">
<p>This field specifies the image that should be used.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>baseImage</code> field is required and should be set to
<code>couchbase/server</code> unless you want Kubernetes to pull the Couchbase
Server docker container from a different location. The value of this
field cannot be changed after the cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="version"><a class="anchor" href="#version"></a>version</h4>
<div class="paragraph">
<p>This field specifies the version number of Couchbase Server to install.
This should match an available version number in the Couchbase Docker
repository. It may never be changed to a lower version number than the
version that is currently running.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>version</code> field is required and should be set to the
version of Couchbase Server that should be used to build the cluster. At
the time of this writing, the Couchbase Operator has only been tested
with enterprise-5.0.1. The value of this field cannot be changed after
the cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="paused"><a class="anchor" href="#paused"></a>paused</h4>
<div class="paragraph">
<p>This field specifies whether or not the Operator is currently managing
this cluster. This parameter should generally be set to <code>true</code>, but may
be set to <code>false</code> if you decide to make manual changes to the cluster.
By disabling the Operator you can change the cluster configuration
without having to worry about the Operator reverting the changes.
However, before re-enabling the Operator, ensure that the Kubernetes
configuration matches the cluster configuration.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>paused</code> field is not required and defaults to
<code>false</code> if not specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="antiaffinity"><a class="anchor" href="#antiaffinity"></a>antiAffinity</h4>
<div class="paragraph">
<p>This field specifies whether or not two pods in this cluster can be
deployed on the same Kubernetes node. In a production setting this
parameter should always be set to <code>true</code> in order to reduce the chance
of data loss in case a Kubernetes node crashes.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>antiAffinity</code> field is not required and defaults to
<code>false</code> if not specified. The value of this field cannot be changed
after the cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="authsecret"><a class="anchor" href="#authsecret"></a>authSecret</h4>
<div class="paragraph">
<p>This field specifies the name of a Kubernetes Secret that should be used
as the user name and password of the Couchbase super-user.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>authSecret</code> field is required and should reference
the name of a
<a href="https://kubernetes.io/docs/concepts/configuration/secret/">Kubernetes
Secret</a> that already exists. The value of this field cannot be changed
after the cluster is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="exposeadminconsole"><a class="anchor" href="#exposeadminconsole"></a>exposeAdminConsole</h4>
<div class="paragraph">
<p>This field specifies whether or not the Couchbase Server Web Console
should be exposed externally. Exposing the web console is done using a
NodePort service and the port for the service can be found in the
describe output when describing this cluster. This parameter may be
changed while the cluster is running and the Operator will
create/destroy the NodePort service as appropriate.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>exposeAdminConsole</code> field is not required and
defaults to <code>false</code> if not specified.</p>
</div>
</div>
<div class="sect3">
<h4 id="adminconsoleservices"><a class="anchor" href="#adminconsoleservices"></a>adminConsoleServices</h4>
<div class="paragraph">
<p>When the Couchbase Server Web Console is exposed, the pod that it is
connected to is chosen based on the client IP address. Since the web
console may display slightly different features based on the services
running on the particular pod it is connected to, we let you specify the
services so that the exposed port will only connect to pods that contain
the services specified for this parameter. A list of one or more
services should be provided. If you do not specify any service, then the
web console will be connected to all pods in the cluster.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>adminConsoleServices</code> list is not required and
defaults to an empty list. An empty list means any node in the cluster
may be chosen when connecting to the Couchbase Server Web Console.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spec-the-cluster-settings"><a class="anchor" href="#spec-the-cluster-settings"></a>Spec: The Cluster Settings</h3>
<div class="paragraph">
<p>This section describes the various Couchbase cluster settings. This
section is not meant to encompass every setting that is configurable on
Couchbase. Cluster settings not mentioned here can be managed manually.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
  cluster:
    dataServiceMemoryQuota: 4096
    indexServiceMemoryQuota: 1024
    searchServiceMemoryQuota: 2048
    indexStorageType: plasma
    autoFailoverTimeout: 30
...</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="dataservicememoryquota"><a class="anchor" href="#dataservicememoryquota"></a>dataServiceMemoryQuota</h4>
<div class="paragraph">
<p>The amount of memory to assign to the data service if it is present on a
specific Couchbase node. The amount of memory is defined in Megabytes
(MB).</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>dataServiceMemoryQuota</code> field is required and must
be set to be greater than or equal to 256. Keep in mind that the sum of
all memory quotas must be no more than 80% of a pod’s available memory.</p>
</div>
</div>
<div class="sect3">
<h4 id="indexservicememoryquota"><a class="anchor" href="#indexservicememoryquota"></a>indexServiceMemoryQuota</h4>
<div class="paragraph">
<p>The amount of memory to assign to the index service if it is present on
a specific Couchbase node. The amount of memory is defined in Megabytes
(MB).</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>indexServiceMemoryQuota</code> field is required and must
be set to be greater than or equal to 256. Keep in mind that the sum of
all memory quotas must be no more than 80% of a pod’s available memory.</p>
</div>
</div>
<div class="sect3">
<h4 id="searchservicememoryquota"><a class="anchor" href="#searchservicememoryquota"></a>searchServiceMemoryQuota</h4>
<div class="paragraph">
<p>The amount of memory to assign to the search service if it is present on
a specific Couchbase node. The amount of memory is defined in Megabytes
(MB). This parameter defaults to 256 MB if it is not set.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>searchServiceMemoryQuota</code> field is required and must
be set to be greater than or equal to 256. Keep in mind that the sum of
all memory quotas must be no more than 80% of a pod’s available memory.</p>
</div>
</div>
<div class="sect3">
<h4 id="indexstoragetype"><a class="anchor" href="#indexstoragetype"></a>indexStorageType</h4>
<div class="paragraph">
<p>Specifies the backend storage type to use for the index service. If the
cluster already contains a Couchbase Server instance running the index
service, then this parameter cannot be changed until all Couchbase
instances running the index service are removed.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>indexStorageType</code> is required and must be set to
either <code>plasma</code> or <code>memory-optimized</code>. The value of this field can only
be changed if there are no index nodes in the cluster.</p>
</div>
</div>
<div class="sect3">
<h4 id="autofailovertimeout"><a class="anchor" href="#autofailovertimeout"></a>autoFailoverTimeout</h4>
<div class="paragraph">
<p>Specifies the auto-failover timeout in seconds. The Operator relies on
the CouchbaseCluster to auto-failover nodes before removing them, so
setting this field to an appropriate value is important.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverTimeout</code> is required and must be greater
than or equal to 5.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spec-bucket-settings"><a class="anchor" href="#spec-bucket-settings"></a>Spec: Bucket Settings</h3>
<div class="paragraph">
<p>This section describes one or more buckets that must be created in the
cluster.</p>
</div>
<div class="paragraph">
<p><em>Note:</em> If you remove an already specified bucket from the
configuration, the Operator will delete that bucket from the cluster.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
  buckets:
    - name: default
      type: couchbase
      memoryQuota: 1024
      replicas: 1
      ioPriority: high
      evictionPolicy: value-eviction
      conflictResolution: seqno
      enableFlush: true
      enableIndexReplica: false
...</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="name"><a class="anchor" href="#name"></a>name</h4>
<div class="paragraph">
<p>This field specifies the name of the bucket. This parameter is required
when specifying a bucket.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>name</code> is required and must be a string using
characters and numbers. The value of this field cannot be changed after
the bucket is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="type"><a class="anchor" href="#type"></a>type</h4>
<div class="paragraph">
<p>This field specifies the type of bucket to create. This parameter can be
set to <code>couchbase</code>, <code>ephemeral</code>, or <code>memcached</code>. If the type is not
specified, it defaults to <code>couchbase</code>.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>type</code> is required and must be set to either
<code>couchbase</code>, <code>ephemeral</code>, or <code>memcached</code>. The value of this field cannot
be changed after the bucket is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="memoryquota"><a class="anchor" href="#memoryquota"></a>memoryQuota</h4>
<div class="paragraph">
<p>This field specifies the amount of memory to allocate to this bucket in
Megabytes (MB). If the quota is not specified, it defaults to 100.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>memoryQuota</code> is required and must be set to greater
than or equal to 100.</p>
</div>
</div>
<div class="sect3">
<h4 id="replicas"><a class="anchor" href="#replicas"></a>replicas</h4>
<div class="paragraph">
<p>This field specifies the number of replicas that should be created for
this bucket. This value may be set between 0 and 3 inclusive. If the
number is not set, it defaults to 1. Note that this parameter has no
effect for the memcached bucket type.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>replicas</code> field is required for buckets with type
<code>couchbase</code> and <code>ephemeral</code> and must be set between 0 and 3. Memcached
buckets will ignore values in this field. Changing the value of this
field will cause a rebalance to occur.</p>
</div>
</div>
<div class="sect3">
<h4 id="iopriority"><a class="anchor" href="#iopriority"></a>ioPriority</h4>
<div class="paragraph">
<p>This field sets the IO priority of background threads for this bucket.
This option is valid for Couchbase and Ephemeral buckets only. Memcached
buckets will ignore values in this field.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>ioPriority</code> is required for buckets with type
<code>couchbase</code> and <code>ephemeral</code> and must be set to either <code>high</code> or <code>low</code>.
Memcached buckets will ignore values in this field. Changing the value
of this field will cause downtime while the bucket is restarted.</p>
</div>
</div>
<div class="sect3">
<h4 id="evictionpolicy"><a class="anchor" href="#evictionpolicy"></a>evictionPolicy</h4>
<div class="paragraph">
<p>This field sets the memory-cache eviction policy for this bucket. This
option is valid for Couchbase and Ephemeral buckets only.</p>
</div>
<div class="paragraph">
<p>Couchbase buckets support either <code>valueOnly</code> or <code>fullEviction</code>.
Specifying the <code>valueOnly</code> policy means that each key stored in this
bucket must be kept in memory. This is the default policy; using this
policy improves the performance of key-value operations, but limits the
maximum size of the bucket. Specifying the <code>fullEviction</code> policy means
that the performance is impacted for key-value operations, but the
maximum size of the bucket is unbounded.</p>
</div>
<div class="paragraph">
<p>Ephemeral buckets support either <code>noEviction</code> or <code>nruEviction</code>.
Specifying <code>noEviction</code> means that the bucket will not evict items from
the cache if the cache is full. This type of eviction policy should be
used for in-memory database use cases.</p>
</div>
<div class="paragraph">
<p>Specifying <code>nruEviction</code> means that items not recently used will be
evicted from memory when all the memory in the bucket is used. This type
of eviction policy should be used for caching use cases.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>evictionPolicy</code> is required for buckets with type
<code>couchbase</code> and <code>ephemeral</code>. Memcached buckets will ignore values in
this field. Changing the value of this field will cause downtime while
the bucket is restarted.</p>
</div>
</div>
<div class="sect3">
<h4 id="conflictresolution"><a class="anchor" href="#conflictresolution"></a>conflictResolution</h4>
<div class="paragraph">
<p>This field specifies the bucket’s conflict resolution mechanism which is
to be used if a conflict occurs during cross-datacenter replication
(XDCR). There are two supported mechanisms: sequence-based and
timestamp-based.</p>
</div>
<div class="paragraph">
<p>The sequence-based conflict resolution mechanism selects the document
that has been updated the greatest number of times since the last sync.
For example, if one cluster has updated a document twice since the last
sync, and the other cluster has updated the document three times, the
document updated three times is selected regardless of the specific
times at which these updates took place.</p>
</div>
<div class="paragraph">
<p>The timestamp-based conflict resolution mechanism selects the document
with the most recent timestamp. This is only supported when all of the
clocks on all of the nodes are fully synchronized.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>conflictResolution</code> field is required for buckets
with type <code>couchbase</code> and <code>ephemeral</code> and can be set to either <code>seqno</code>
or <code>lww</code>. Memcached buckets will ignore values in this field. The value
of this field cannot be changed after the bucket has been created.</p>
</div>
</div>
<div class="sect3">
<h4 id="enableflush"><a class="anchor" href="#enableflush"></a>enableFlush</h4>
<div class="paragraph">
<p>This field specifies whether or not to enable the flush command on this
bucket. This parameter defaults to <code>false</code> if it is not specified. This
parameter only affects Couchbase and Ephemeral buckets.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>enableFlush</code> field can be set to either <code>true</code> or
<code>false</code>. If this parameter is not specified, it defaults to <code>false</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="enableindexreplicas"><a class="anchor" href="#enableindexreplicas"></a>enableIndexReplicas</h4>
<div class="paragraph">
<p>This field specifies whether or not to enable view index replicas for
this bucket. This parameter defaults to <code>false</code> if it is not specified.
This parameter only affects Couchbase buckets.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>enableIndexReplicas</code> field is required for buckets
with type <code>couchbase</code> and can be set to either <code>true</code> or <code>false</code>.
Memcached and Ephemeral buckets will ignore values in this field.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers"><a class="anchor" href="#spec-servers"></a>Spec: Servers</h3>
<div class="paragraph">
<p>You must specify at least one - but possibly multiple - node
specifications. A node specification is used to allow multi-dimensional
scaling of a Couchbase cluster with Kubernetes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
  servers:
  - size: 1
    name: all_services
    services:
      - data
      - index
      - query
      - search
    dataPath: /opt/couchbase/var/lib/couchbase/data
    indexPath: /opt/couchbase/var/lib/couchbase/data
    pod:
      couchabseEnv:
        CB_ENV_VAR: value
      resources:
        limits:
          cpu: 4GHz
          memory: 8GiB
          storage: 100GiB
        requests:
          cpu: 2GHz
          memory: 8GiB
          storage: 50GiB
      labels:
        couchbase_services: all
      nodeSelector:
        instanceType: large
      tolerations:
        - key: app
          operator: Equal
          value: cbapp
          effect: NoSchedule</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Specification rules:</em> The <code>servers</code> portion of the specification is
required and must always contain at least one server definition. There
must also be at least one definition that contains the data service.</p>
</div>
<div class="sect3">
<h4 id="size"><a class="anchor" href="#size"></a>size</h4>
<div class="paragraph">
<p>This field specifies the number of nodes of this type that should be in
the cluster. This allows the user to scale up different parts of the
cluster as necessary. If this parameter is changed at runtime, the
Operator will automatically scale the cluster.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>size</code> is required and can be set to greater than or
equal to 1.</p>
</div>
</div>
<div class="sect3">
<h4 id="name-1"><a class="anchor" href="#name-1"></a>name</h4>
<div class="paragraph">
<p>This field specifies a name for this group of servers.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>name</code> field is required and must be unique in
comparison to the <code>name</code> field of other server definitions. The value of
this field cannot be changed after a server has been defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="services"><a class="anchor" href="#services"></a>services</h4>
<div class="paragraph">
<p>This field specifies a list of services that should be run on nodes of
this type. Users can specify <code>data</code>, <code>index</code>, <code>query</code>, and <code>search</code> in
the list. At least one service must be specified and all clusters must
contain at least one node specification that includes the data service.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>services</code> list is required and must contain at least
one service. Valid values for services are <code>data</code>, <code>index</code>, <code>query</code>, and
<code>search</code>. The values of this list cannot be changed after a server has
been defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="datapath"><a class="anchor" href="#datapath"></a>dataPath</h4>
<div class="paragraph">
<p>This field specifies the path where data from the data service should be
stored. This parameter is required.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>dataPath</code> is required and be set to a valid path.
The value of this field cannot be changed after a server has been
defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="indexpath"><a class="anchor" href="#indexpath"></a>indexPath</h4>
<div class="paragraph">
<p>This field specifies the path were data created by indexes should be
stored. This parameter is required.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>indexPath</code> is required and be set to a valid path.
The value of this field cannot be changed after a server has been
defined.</p>
</div>
</div>
<div class="sect3">
<h4 id="the-pod-policy"><a class="anchor" href="#the-pod-policy"></a>The Pod Policy</h4>
<div class="paragraph">
<p>The pod policy defines settings that apply to all pods deployed with
this node configuration. A pod always contains a single running instance
of Couchbase Server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
    pod:
      couchbaseEnv:
        CB_ENV_VAR: value
      resources:
        limits:
          cpu: 4GHz
          memory: 8GiB
          storage: 100GiB
        requests:
          cpu: 2GHz
          memory: 8GiB
          storage: 50GiB
      labels:
        couchbase_services: all
      nodeSelector:
        instanceType: large
      tolerations:
        - key: app
          operator: Equal
          value: cbapp
          effect: NoSchedule</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="couchbaseenv"><a class="anchor" href="#couchbaseenv"></a>couchbaseEnv</h5>
<div class="paragraph">
<p>This field specifies the environment variables (as key-values pairs)
that should be set when the pod is started. The key in this case is the
environment variable name and the value is the value of the environment
variable. This section is optional.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field cannot be changed after a server
has been defined.</p>
</div>
</div>
<div class="sect4">
<h5 id="resources"><a class="anchor" href="#resources"></a>Resources</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">...
    resources:
      limits:
        cpu: 2GHz
        memory: 8GiB
        storage: 100GiB
      requests:
        cpu: 1.5GHz
        memory: 8GiB
        storage: 50GiB
...</code></pre>
</div>
</div>
<div id="limits" class="paragraph">
<p>limits</p>
</div>
<div class="paragraph">
<p>This field lets you reserve resources on a specific node. It defines the
maximum amount of CPU, memory, and storage the pods created in this node
specification will reserve.</p>
</div>
<div id="requests" class="paragraph">
<p>requests</p>
</div>
<div class="paragraph">
<p>This field lets you reserve resources on a specific node. The requests
section defines the minimum amount of CPU, memory, and storage the pods
created in this node specification will reserve.</p>
</div>
<div class="paragraph">
<p>See the Kubernetes documentation for further information about
<a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/">managing
compute resources</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="labels"><a class="anchor" href="#labels"></a>labels</h5>
<div class="paragraph">
<p>Labels are key-value pairs that are attached to objects in Kubernetes.
They are intended to specify identifying attributes of objects that are
meaningful to the user and do not directly imply semantics to the core
system. Labels can be used to organize and select subsets of objects.
They do not need to be unique across multiple objects. This section is
optional.</p>
</div>
<div class="paragraph">
<p>Labels added in this section will apply to all pods added in this
cluster. Note that by default we add the following labels to each pod,
which should not be overridden.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>app:couchbase
couchbase_cluster:&lt;metadata:name&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In the sample configuration file referenced in this topic, the label
would be <code>couchbase_cluster:cb-example</code>.</p>
</div>
<div class="paragraph">
<p>The label for the first pod is of the format:
<code>couchbase_node: &lt;metadata:name&gt;-&lt;gen node id&gt;</code>.</p>
</div>
<div class="paragraph">
<p>In the sample configuration file referenced in this topic, the label for
the first pod would be <code>couchbase_node:cb-example-0000</code>.</p>
</div>
<div class="paragraph">
<p>For more information, see the Kubernetes documentation about
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/">labels</a>.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field cannot be changed after a server
has been defined.</p>
</div>
</div>
<div class="sect4">
<h5 id="nodeselector"><a class="anchor" href="#nodeselector"></a>nodeSelector</h5>
<div class="paragraph">
<p>This field specifies a key-value map of the constraints on node
placement for pods. For a pod to be eligible to run on a node, the node
must have each of the indicated key-value pairs as labels (it can have
additional labels as well). If this section is not specified, then
Kubernetes will place the pod on any available node. For more
information, see the Kubernetes documentation about
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors">label
selectors</a>.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field cannot be changed after a server
has been defined.</p>
</div>
</div>
<div class="sect4">
<h5 id="tolerations"><a class="anchor" href="#tolerations"></a>tolerations</h5>
<div class="paragraph">
<p>This field specifies conditions upon which a node should not be selected
when deploying a pod. From the sample configuration file referenced in
this topic, you can see that any node with a label <code>app:cbapp</code> should
not be allowed to run the pod defined in this node specification. You
might do this if you have nodes dedicated for running an application
using Couchbase where you don’t want the database and application to be
running on the same node. For more information about tolerations, see
the Kubernetes documentation on
<a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/">taints
and tolerations</a>. The tolerations section is optional.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field cannot be changed after a server
has been defined.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
      <script>
        /* From https://stackoverflow.com/questions/18294759/use-javascript-to-add-a-css-class-to-all-elements-with-another-class-name */
        window.onload = function() {
          var buttons = document.querySelectorAll(".body .anchor"),
            len = buttons !== null ? buttons.length : 0,
            i = 0;
          for(i; i < len; i++) {
            buttons[i].className += " instructions";
          }
        }
      </script>
      <script>
        /* Inline script to remove the h1 heading when the page is rendered on the dev portal.
           Important otherwise it is displayed twice. */
        if (window.location.host === 'www.couchbaseinc.acct.us.onehippo.com' || window.location.host === 'developer.couchbase.com') {
          var heading = document.querySelector('div.body h1');
          heading.style.display = 'none';
        }
      </script>
      <script>
        /* Script to remove leading whitespace in code snippets.
         * Fix found on StackOverflow: https://stackoverflow.com/a/26230865/1908348 */
        [].forEach.call(document.querySelectorAll('code'), function($code) {
          var lines = $code.textContent.split('\n');
          if (lines[0] === '') {
            lines.shift()
          }

          var matches;
          var indentation = (matches = /^[\s\t]+/.exec(lines[0])) !== null ? matches[0] : null;
          if (!!indentation) {
            lines = lines.map(function(line) {
              line = line.replace(indentation, '')
              return line.replace(/\t/g, '    ')
            });

            $code.textContent = lines.join('\n').trim();
          }
        });
      </script>
    </div>
  </main>
</div>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>

<!-- Require_js bootstrap for app-specific JS module support -->
<!-- data-main attribute tells require.js to load
scripts/main.js after require.js loads. -->
<script type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/require.js"></script>
<script type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/thirdparty/vendor/prism.js"></script>
<script rel="main" type="text/javascript" src="https://developer.couchbase.com/webfiles/1498186094252/js/main.js" ></script>
<!-- leave the main attribute, it is used to help main.js determine -->
<!-- the domain-relative path to the base script (main.js) -->  </body>
</html>
