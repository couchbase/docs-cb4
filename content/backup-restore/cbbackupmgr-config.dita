<?xml version="1.0" encoding="UTF-8"?>
<!-- GENERATED BY man2dita. DO NOT EDIT THIS DOCUMENT DIRECTLY. -->
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="cbbackupmgr-config.1">
  <title>cbbackupmgr config</title>
  <body>
    <section>
      <title>Name</title>
      <p>cbbackupmgr-config - Creates and configures a new backup repository </p>
    </section>
    <section>
      <title>Synopsis</title>
      <p><i>cbbackupmgr config</i> [--archive &lt;archive_dir&gt;] [--repo &lt;repo_name&gt;] [--exclude-buckets &lt;bucket_list&gt;] [--include-buckets &lt;bucket_list&gt;] [--disable-bucket-config] [--disable-views] [--disable-gsi-indexes] [--disable-ft-indexes] [--disable-data] </p>
    </section>
    <section>
      <title>Description</title>
      <p>Creates a new backup repository with a new backup configuration. The configuration created is used for all backups in this backup repository. </p>
      <p>By default a backup configuration is created that will backup all buckets in the cluster. Each bucket will have its bucket configuration, views definitions, gsi index definitions, full-text index definitions, and data backed up. Specifying various flags, the <i>config</i> command can modify the configuration to backup a subset of the data. </p>
      <p>Once a backup repository is created its configuration cannot be changed. </p>
    </section>
    <section>
      <title>Options</title>
      <p>Below are a list of required and optional parameters for the config command. </p>
      <b>Required</b>
      <p>--archive &lt;archive_dir&gt; </p><sl>
        <sli>The directory where the new backup repository will be created. 
If it does not already exist, an attempt will be made to create it. 
        </sli></sl>
      <p>--repo &lt;repo_name&gt; </p><sl>
        <sli>The name of the new backup repository. 
        </sli></sl>
      <b>Optional</b>
      <p>--exclude-buckets &lt;bucket_list&gt; </p><sl>
        <sli>Modifies the repository configuration to back up all buckets not specified in &lt;bucket_list&gt;. 
This flag cannot be specified at the same time as the --include-buckets flag. 
Takes a comma separated list of bucket names. 
        </sli></sl>
      <p>--include-buckets &lt;bucket_list&gt; </p><sl>
        <sli>Modifies the repository configuration to only back up the buckets specified in &lt;bucket-list&gt;. 
This flag cannot be specified at the same time as the --exclude-buckets flag. 
Takes a comma separated list of bucket names. 
        </sli></sl>
      <p>--disable-views </p><sl>
        <sli>Modifies the repository configuration to disable backing up view definitions for all buckets. 
        </sli></sl>
      <p>--disable-gsi-indexes </p><sl>
        <sli>Modifies the repository configuration to disable backing up gsi index definitions for all buckets. 
        </sli></sl>
      <p>--disable-ft-indexes </p><sl>
        <sli>Modifies the repository configuration to disable backing up full-text index definitions for all buckets. 
        </sli></sl>
      <p>--disable-data </p><sl>
        <sli>Modifies the repository configuration to disable backing up all key-value data for all buckets. 
        </sli></sl>
    </section>
    <section>
      <title>Examples</title>
      <p>The <i>config</i> command is used to create a backup repository and define the repositories backup configuration. In the examples below, the backup archive is located at /data/backups. Since this is the first backup repository we are creating in a new backup archive, we need to ensure that /data/backups is an empty directory. Archives are created automatically if an archive doesn't already exist at the archive path, but are only created if the directory at that path is empty. In order to create a backup repository called "example" with the default configuration use the following command: </p>
      <codeblock>$ cbbackupmgr config --archive /data/backups --repo example </codeblock>
      <p>Upon creation of a new backup repository there will be a new directory in the backup archive containing a backup configuration. You can see this new directory using the <xref href="cbbackupmgr-list.dita"/> command. </p>
      <codeblock>$ cbbackupmgr list --archive /data/backups 
Size      Items          Name 
0B        -              + example </codeblock>
      <p>Using the optional parameters of the <i>create</i> command, you can modify the backup configuration settings. To create a backup repository with a backup configuration that only backs up the buckets "airline_data" and "ticket_prices" and does not back up up bucket configuration data, you can run the following: </p>
      <codeblock>$ cbbackupmgr config --archive /data/backups --repo example \ 
--include-buckets airline_data,ticket_prices --disable-bucket-config </codeblock>
      <p>To create a backup repository with a backup configuration that backs up only data on all buckets, you can run the following command: </p>
      <codeblock>$ cbbackupmgr config --archive /data/backups --repo example \ 
--disable-bucket-config --disable-views --disable-gsi-indexes \ 
--disable-ft-indexes </codeblock>
    </section>
    <section>
      <title>Discussion</title>
      <p>Though not required, it is recommended that there is a single backup repository per cluster. Backup repositories are managed so that all backups can be taken incrementally and merged together as backup data ages. Backing up in this manner allows backups to transfer the least amount of data necessary which reduces back up time and cluster resource usage. For more details on backup strategies see <xref href="cbbackupmgr-strategies.dita"/>. </p>
      <p>When a backup repository is created, it should only be modified by the <i>cbbackupmgr</i> utility. Any modifications done outside of this utility can cause corruption of backup files. </p>
    </section>
    <section>
      <title>Environment And Configuration Variables</title>
      <p>(None) </p>
    </section>
    <section>
      <title>Files</title>
      <p>backup-meta.json </p><sl>
        <sli>The <i>config</i> command creates a backup configuration file in the backup repository called backup-meta.json. 
This file contains the backup configuration for all backups run in the backup repository it was created in. 
It should never be modified and treated as a read-only file. 
        </sli></sl>
    </section>
    <section>
      <title>See Also</title>
      <p><xref href="cbbackupmgr-list.dita"/>, <xref href="cbbackupmgr-strategies.dita"/> </p>
    </section>
    <section>
      <title>Cbbackupmgr</title>
      <p>Part of the <xref href="cbbackupmgr.dita"/> suite </p>
    </section>
  </body>
</topic>