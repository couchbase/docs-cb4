<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Couchbase Documentation</title>
    <meta name="generator" content="Antora 1.0.0">
    <link rel="stylesheet" href="../../_/css/site.css">
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Couchbase Documentation</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="main-wrapper">
<div class="navigation-container" data-component="kafka" data-version="3.4">
  <aside class="navigation" role="navigation">
    <div class="panels">
<div class="navigation-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="quickstart.html">Kafka</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-toggle"></button>
    <span class="nav-text">Kafka</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="quickstart.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="source-configuration-options.html">Source Configuration Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="sink-configuration-options.html">Sink Configuration Options</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="streams-sample.html">Couchbase Sample with Kafka Streams</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="release-notes.html">Release Notes</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="navigation-explore" data-panel="explore">
  <div class="context">
    <span class="title">Kafka</span>
    <span class="version">3.4</span>
  </div>
  <ul class="components">
    <li class="component">
      <span class="title">Couchbase Lite</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../couchbase-lite/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="../../couchbase-lite/2.0/index.html">2.0</a>
        </li>
        <li class="version">
          <a href="../../couchbase-lite/1.4/index.html">1.4</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <span class="title">Kafka</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="quickstart.html">3.4</a>
        </li>
        <li class="version">
          <a href="../3.3/quickstart.html">3.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <span class="title">Sync Gateway</span>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sync-gateway/2.1/index.html">2.1</a>
        </li>
        <li class="version">
          <a href="../../sync-gateway/2.0/index.html">2.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
  <main class="main" role="main">
<div class="toolbar" role="navigation">
  <button class="navigation-toggle"></button>
<nav class="crumbs" role="navigation" aria-label="breadcrumbs">
  <ul>
    <li class="crumb">Kafka</li>
    <li class="crumb"><a href="quickstart.html">Quickstart</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="versions-menu-toggle" title="Show other versions of page">3.4</button>
  <div class="versions-menu">
    <a class="version is-current" href="quickstart.html">3.4</a>
    <a class="version" href="../3.3/quickstart.html">3.3</a>
  </div>
</div>
  <div class="edit-this-page"><a href="file:///Users/jamesnocentini/Developer/docs-site/kafka-connect-couchbase/docs/modules/ROOT/pages/quickstart.adoc">Edit this Page</a></div>
</div>
    <div class="body">
      <style>
        .doc h1 > a.anchor,
        .doc h2 > a.anchor,
        .doc h3 > a.anchor,
        .doc h4 > a.anchor,
        .doc h5 > a.anchor,
        .doc h6 > a.anchor {
          position: absolute;
          text-decoration: none;
          width: 1.75ex;
          margin-left: -1.5ex;
          visibility: hidden;
          font-size: 0.8em;
        }
        .doc h1 > a.anchor::before,
        .doc h2 > a.anchor::before,
        .doc h3 > a.anchor::before,
        .doc h4 > a.anchor::before,
        .doc h5 > a.anchor::before,
        .doc h6 > a.anchor::before {
          content: "\00a7";
        }
        .doc h1:hover > a.anchor,
        .doc h2:hover > a.anchor,
        .doc h3:hover > a.anchor,
        .doc h4:hover > a.anchor,
        .doc h5:hover > a.anchor,
        .doc h6:hover > a.anchor {
          visibility: visible;
        }
      </style>
      <article class="doc">
<div class="paragraph">
<p>This section shows how to add the connector to your application.</p>
</div>
<div class="sect1">
<h2 id="download"><a class="anchor" href="#download"></a>Download</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The connector is shipped as a zip archive, available for download:
<a href="https://packages.couchbase.com/clients/kafka/3.3.2/kafka-connect-couchbase-3.3.2.zip">kafka-connect-couchbase-3.3.2.zip</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A beta version with support for rollback mitigation is also available.
Try it and let us know about your experience:
<a href="https://packages.couchbase.com/clients/kafka/3.4.0-beta.1/kafka-connect-couchbase-3.4.0-beta.1.zip">kafka-connect-couchbase-3.4.0-beta.1.zip</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you prefer to build the connectors from source, clone the
<a href="https://github.com/couchbase/kafka-connect-couchbase">GitHub repository</a>
and run <code>mvn package</code> to generate the connector archive (look for
<code>kafka-connect-couchbase-&lt;version&gt;.zip</code> in the <code>target</code> directory).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started"><a class="anchor" href="#getting-started"></a>Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>However you obtained the connector archive, go ahead and unzip it now.
The result should be a directory called
<code>kafka-connect-couchbase-&lt;version&gt;</code>. The rest of this guide will refer
to this directory as <code>$KAFKA_CONNECT_COUCHBASE_HOME</code>.</p>
</div>
<div class="paragraph">
<p>This guide assumes you have already installed Couchbase Server locally
and have loaded the sample bucket called <code>travel-sample</code>. (It&#8217;s fine if
you want to use a different bucket; neither the connector nor this guide
depend on the contents of the documents in the bucket.)</p>
</div>
<div class="paragraph">
<p>You&#8217;ll also need a local installation of Apache Kafka or Confluent
Platform Kafka.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="set-up-kafka"><a class="anchor" href="#set-up-kafka"></a>Set Up Kafka</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you already have an installation of Kafka and know how to start the
servers, feel free to skip this section.</p>
</div>
<div class="paragraph">
<p>Still reading? Don&#8217;t worry, setting up a basic installation is pretty
easy. Download either <a href="https://kafka.apache.org/downloads">Apache Kafka</a>
or <a href="https://www.confluent.io/download/">Confluent Platform Kafka</a>. For
simplicity, this guide assumes you&#8217;re installing from a ZIP or TAR
archive, so steer clear of the deb/rpm packages for now.</p>
</div>
<div class="paragraph">
<p>Decompress the Apache Kafka or Confluent Platform archive and move the
resulting directory under <code>~/opt</code> (or wherever you like to keep this
kind of software). The rest of this guide refers to the root of the
installation directory as <code>$KAFKA_HOME</code> or <code>$CONFLUENT_HOME</code>. Be aware
that some config files are in different relative locations depending on
whether you&#8217;re using Apache Kafka or Confluent Platform Kafka.</p>
</div>
<div class="paragraph">
<p>Make sure the Kafka command line tools are in your path:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export PATH=&lt;path-to-apache-kafka-or-confluent&gt;/bin:$PATH</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="start-the-kafka-servers"><a class="anchor" href="#start-the-kafka-servers"></a>Start the Kafka Servers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you&#8217;re using Confluent Platform Kafka, start the servers by running
these commands, <strong>each in a separate terminal</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">zookeeper-server-start $CONFLUENT_HOME/etc/kafka/zookeeper.properties
kafka-server-start $CONFLUENT_HOME/etc/kafka/server.properties
schema-registry-start $CONFLUENT_HOME/etc/schema-registry/schema-registry.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note: Confluent 3.3.0 introduced a CLI tool that lets you start all the
servers with a single command. It also provides a more sophisticated way
to manage connectors than the technique described in this guide. Read
about it <a href="http://docs.confluent.io/current/connect/quickstart.html">here</a>.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re not using Confluent, the commands are slightly different, but
the idea is the same. Start the servers by running these commands, <strong>each
in a separate terminal</strong>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">zookeeper-server-start.sh $KAFKA_HOME/config/zookeeper.properties
kafka-server-start.sh $KAFKA_HOME/config/server.properties</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-the-source-connector"><a class="anchor" href="#configure-the-source-connector"></a>Configure the Source Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Couchbase connector distribution includes sample config files. Look
inside <code>$KAFKA_CONNECT_COUCHBASE_HOME/config</code> and edit the
<code>quickstart-couchbase-source.properties</code> file.</p>
</div>
<div class="paragraph">
<p>Take a moment to peruse the configuration options specified here. Some
are <a href="https://kafka.apache.org/documentation/#connect_configuring">standard
options available to all connectors</a>. The rest are specific to the
Couchbase connector.</p>
</div>
<div class="paragraph">
<p>For this exercise, change the value of <code>connection.bucket</code> to
<code>travel-sample</code> (or whichever bucket you want to stream from). For
<code>connection.username</code> and <code>connection.password</code>, supply the credentials
of a Couchbase user who has the "Data DCP Reader" role for the bucket.
If you have not yet created such a user, now is a good time to read
about
<a href="../../security/security-rbac-for-admins-and-apps.html">Creating and
Managing Users with the UI</a>.</p>
</div>
<div class="paragraph">
<p>Note: For Couchbase Server versions prior to 5.0, leave the username
blank. Set the password property to the bucket password, or leave it
blank if the bucket does not have a password. The sample buckets do not
have passwords.</p>
</div>
<div class="paragraph">
<p>You might also want to set <code>use_snapshots</code> to <code>true</code>, in which case the
source connector will buffer events until it receives a complete
snapshot before committing messages to the Kafka topic. It doesn&#8217;t
matter for this exercise; just be aware the option exists and defaults
to <code>false</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="run-the-source-connector"><a class="anchor" href="#run-the-source-connector"></a>Run the Source Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kafka connectors can be run in
<a href="https://kafka.apache.org/documentation/#connect_running">standalone or
distributed</a> mode. For now let&#8217;s run the connector in standalone mode,
using the CLASSPATH environment variable to include the Couchbase
connector JAR in the class path.</p>
</div>
<div class="paragraph">
<p>For Confluent Platform Kafka:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $KAFKA_CONNECT_COUCHBASE_HOME
env CLASSPATH=./* \
    connect-standalone $CONFLUENT_HOME/etc/schema-registry/connect-avro-standalone.properties \
                       config/quickstart-couchbase-source.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or for Apache Kafka:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $KAFKA_CONNECT_COUCHBASE_HOME
env CLASSPATH=./* \
    connect-standalone.sh $KAFKA_HOME/config/connect-standalone.properties \
                       config/quickstart-couchbase-source.properties</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="alternatively-run-the-connector-with-class-loader-isolation"><a class="anchor" href="#alternatively-run-the-connector-with-class-loader-isolation"></a>Alternatively, Run the Connector with Class Loader Isolation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Kafka version 0.11.0 (and Confluent Platform 3.3.0) introduced a
mechanism for plugin class path isolation. To take advantage of this
feature, edit the connect worker config file (the <code>connect-*.properties</code>
file in the above commands). Modify the <code>plugin.path</code> property to
include the parent directory of <code>kafka-connect-couchbase-&lt;version&gt;.jar</code>.</p>
</div>
<div class="paragraph">
<p>Run the connector using the same commands as above, but omitting the
<code>env CLASSPATH=./*</code> prefix. Each Kafka Connect plugin will use a
separate class loader, removing the possibility of dependency conflicts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="observe-messages-published-by-couchbase-source-connector"><a class="anchor" href="#observe-messages-published-by-couchbase-source-connector"></a>Observe Messages Published by Couchbase Source Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The sample config file tells the source connector to publish to a topic
called <code>test-default</code>. Let&#8217;s use the Kafka command-line tools to spy on
the contents of the topic.</p>
</div>
<div class="paragraph">
<p>For Confluent Platform Kafka:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kafka-avro-console-consumer --bootstrap-server localhost:9092 \
                            --topic test-default --from-beginning</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or for Apache Kafka:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kafka-console-consumer.sh --bootstrap-server localhost:9092 \
                          --topic test-default --from-beginning</code></pre>
</div>
</div>
<div class="paragraph">
<p>The expected output is a stream of Couchbase event notification
messages, at least one for each document in the bucket. The messages
include document metadata as well as content. The document content is
transferred as a byte array (encoded as Base64 if the connector is
configured to use JSON for message values).</p>
</div>
<div class="paragraph">
<p>Each message has an <code>event</code> field whose value indicates the type of
change represented by the message. The possible values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>mutation</code>: A change to document content, including creation and
changes made via subdocument commands.</p>
</li>
<li>
<p><code>deletion</code>: Removal or expiration of the document.</p>
</li>
<li>
<p><code>expiration</code>: Reserved for document expiration (Couchbase Server does
not currently send this event type, but may in future versions).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the consumer catches up to the current state of the bucket, try
<a href="../../sdk/webui-cli-access.html">adding a new document to the bucket
via the Couchbase Web Console</a>. The consumer will print a notification
of type <code>mutation</code>. Now delete the document and watch for an event of
type <code>deletion</code>.</p>
</div>
<div class="paragraph">
<p>Perhaps it goes without saying, but all of the offset management and
fault tolerance features of Kafka Connect work with the Couchbase
connector. You can kill and restart the processes and they will pick up
where they left off.</p>
</div>
<div class="paragraph">
<p>The shape of the message payload is controlled by the
<code>dcp.message.converter.class</code> property of the connector config. By
default it is set to
<code>com.couchbase.connect.kafka.converter.SchemaConverter</code>, which formats
each notification into a structure that holds document metadata and
contents. For reference, the Avro schema for this payload format is
shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "type": "record",
  "name": "DcpMessage",
  "namespace": "com.couchbase",
  "fields": [
    {
      "name": "event",
      "type": "string"
    },
    {
      "name": "partition",
      "type": {
        "type": "int",
        "connect.type": "int16"
      }
    },
    {
      "name": "key",
      "type": "string"
    },
    {
      "name": "cas",
      "type": "long"
    },
    {
      "name": "bySeqno",
      "type": "long"
    },
    {
      "name": "revSeqno",
      "type": "long"
    },
    {
      "name": "expiration",
      "type": [
        "null",
        "int"
      ]
    },
    {
      "name": "flags",
      "type": [
        "null",
        "int"
      ]
    },
    {
      "name": "lockTime",
      "type": [
        "null",
        "int"
      ]
    },
    {
      "name": "content",
      "type": [
        "null",
        "bytes"
      ]
    }
  ],
  "connect.name": "com.couchbase.DcpMessage"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-sink-connector"><a class="anchor" href="#couchbase-sink-connector"></a>Couchbase Sink Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now let&#8217;s talk about the sink connector, which reads messages from one
or more Kafka topics and writes them to Couchbase Server.</p>
</div>
<div class="paragraph">
<p>The sink connector will attempt to convert message values to JSON. If
the conversion fails, the connector will fall back to treating the value
as a String BLOB.</p>
</div>
<div class="paragraph">
<p>If the Kafka key is a primitive type, the connector will use it as the
document ID. If the Kafka key is absent or of complex type (array or
struct), the document ID will be generated as <code>topic/partition/offset</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, the document ID can come from the body of the Kafka
message. Provide a <code>couchbase.document.id</code> property whose value is a
JSON Pointer identifying the document ID node. If you want the connector
to remove this node before persisting the document to Couchbase, provide
a <code>couchbase.remove.document.id</code> property with value <code>true</code>. If the
connector fails to locate the document ID node, it will fall back to
using the Kafka key or <code>topic/partition/offset</code> as described above.</p>
</div>
<div class="paragraph">
<p>As of version 3.2.2, if the Kafka message body is null, the sink
connector will delete the Couchbase document whose ID matches the Kafka
message key.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configure-and-run-the-sink-connector"><a class="anchor" href="#configure-and-run-the-sink-connector"></a>Configure and Run the Sink Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the <code>$KAFKA_CONNECT_COUCHBASE_HOME/config</code> directory there is a file
called <code>quickstart-couchbase-sink.properties</code>. Customize this file as
described in
<a href="#kafka-3-quickstart__configure_source_connector">Configure the
Source Connector</a>, only now the bucket will receive messages and the
user must have <em>write</em> access to the bucket.</p>
</div>
<div class="paragraph">
<p>Note: Make sure to specify an existing bucket, otherwise the sink
connector will fail. You may wish to
<a href="../../clustersetup/create-bucket.html">create a new bucket</a> to
receive the messages.</p>
</div>
<div class="paragraph">
<p>To run the sink connector, use the same command as described in <strong>Run the
Source Connector</strong>, but pass <code>quickstart-couchbase-sink.properties</code> as
the second argument to <code>connect-standalone</code> instead of
<code>quickstart-couchbase-source.properties</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="send-test-messages"><a class="anchor" href="#send-test-messages"></a>Send Test Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that the Couchbase Sink Connector is running, let&#8217;s give it some
messages to import:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd $KAFKA_CONNECT_COUCHBASE_HOME/examples/json-producer
mvn compile exec:java</code></pre>
</div>
</div>
<div class="paragraph">
<p>The producer will send some messages and then terminate. If all goes
well, the messages will appear in the Couchbase bucket you specified in
the sink connector config..</p>
</div>
<div class="paragraph">
<p>If you wish to see how the Couchbase Sink Connector behaves in the
absence of message keys, modify the <code>publishMessage</code> method in the
example source code to set the message keys to null, then rerun the
producer.</p>
</div>
<div class="paragraph">
<p>Alternatively, if you want the Couchbase document ID to be the airport
code, edit <code>quickstart-couchbase-sink.properties</code> and set
<code>couchbase.document.id=/airport</code>, restart the sink connector, and run
the producer again.</p>
</div>
<div class="paragraph">
<p><strong>Parent topic:</strong> <a href="kafka-intro.html">Kafka Connector</a></p>
</div>
<div class="paragraph">
<p><strong>Next topic:</strong>
<a href="source-configuration-options.html">Source Configuration Options</a></p>
</div>
</div>
</div>
</article>
      <script>
        /* From https://stackoverflow.com/questions/18294759/use-javascript-to-add-a-css-class-to-all-elements-with-another-class-name */
        window.onload = function() {
          var buttons = document.querySelectorAll(".body .anchor"),
            len = buttons !== null ? buttons.length : 0,
            i = 0;
          for(i; i < len; i++) {
            buttons[i].className += " instructions";
          }
        }
      </script>
      <script>
        /* Inline script to remove the h1 heading when the page is rendered on the dev portal.
           Important otherwise it is displayed twice. */
        if (window.location.host === 'www.couchbaseinc.acct.us.onehippo.com' || window.location.host === 'developer.couchbase.com') {
          var heading = document.querySelector('div.body h1');
          heading.style.display = 'none';
        }
      </script>
      <script>
        /* Script to remove leading whitespace in code snippets.
         * Fix found on StackOverflow: https://stackoverflow.com/a/26230865/1908348 */
        [].forEach.call(document.querySelectorAll('code'), function($code) {
          var lines = $code.textContent.split('\n');
          if (lines[0] === '') {
            lines.shift()
          }
          var matches;
          var indentation = (matches = /^[\s\t]+/.exec(lines[0])) !== null ? matches[0] : null;
          if (!!indentation) {
            lines = lines.map(function(line) {
              line = line.replace(indentation, '')
              return line.replace(/\t/g, '    ')
            });
            $code.textContent = lines.join('\n').trim();
          }
        });
      </script>
    </div>
  </main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../../_/js/site.js"></script>
<script src="../../_/js/vendor/highlight.js"></script>
<script>hljs.initHighlighting()</script>
  </body>
</html>
